proxy_cache_path  /var/cache/nginx levels=1:2 keys_zone=my-cache:8m max_size=1000m inactive=600m;
proxy_temp_path /var/tmp;
server {
    listen 80;
    server_name sig2.mca.gov.py;
    root /home/agimenez/Desktop/MCA/Desarrollo/sig.mca.gov.py/htdocs;
    rewrite_log on;

    location / {
        index index.html index.htm index.php;
        if (!-d $request_filename)
        {
            rewrite ^/(.+)/$ /$1 permanent;
        }
        
        if (!-f $request_filename) {
            rewrite ^/(.*)$ /index.php?/$1 last;
            break;
        }
    }

    location ~ \.php$ {
       include /etc/nginx/fastcgi.conf;
       fastcgi_pass  unix:/tmp/php.socket;
       fastcgi_index index.php;
       fastcgi_param CODIGNITER_DIR "/home/agimenez/Desktop/ProyectoWeb/librerias/PHP/CodeIgniter_2.1.0/";
    }

    location /gisapi/ {
        proxy_pass http://200.61.225.58:8399/arcgis/rest/services/;
        proxy_cache my-cache;
        proxy_cache_valid  200 302  60m;
        proxy_cache_valid  404      1m;
        proxy_ignore_headers X-Accel-Expires Expires Cache-Control;
    }

    location ~ /\.ht {
        deny  all;
    }

    location /arcgis/rest/ {
    add_header 'Access-Control-Allow-Origin' '*';
    proxy_pass http://<asusig>:8399/arcgis/rest/;
}

location /arcgis/services/ {
     add_header 'Access-Control-Allow-Origin' '*';
     proxy_pass http://<asusig>:8399/arcgis/services/;
}
}

